(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5],{52:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var n=r(5155),l=r(6874),i=r.n(l),d=r(2115);function a(){let[e,t]=(0,d.useState)([]),[r,l]=(0,d.useState)(""),[i,a]=(0,d.useState)(""),[o,s]=(0,d.useState)(!1);(0,d.useEffect)(()=>{try{let e=localStorage.getItem("applyCart");t(e?JSON.parse(e):[])}catch(e){t([]),localStorage.removeItem("applyCart")}},[]);let p=(r,n)=>{let l=[...e];l[r].count=n,t(l),localStorage.setItem("applyCart",JSON.stringify(l))},c=r=>{let n=[...e];n.splice(r,1),t(n),localStorage.setItem("applyCart",JSON.stringify(n))},g=async n=>{if(n.preventDefault(),!i||!r)return void alert("請填寫領用日期與原因");let l=JSON.parse(localStorage.getItem("loginUser")||"null");for(let t of e)await fetch("https://api.sheetbest.com/sheets/02b3aceb-e524-4741-b358-a70e97fe9b52",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({申請id:Date.now()+Math.random(),宣導品id:t.id,宣導品名稱:t.name,領用數量:t.count||1,領用日期:i,領用原因:r,申請人:l?l.username:"",狀態:"待審核"})});s(!0),t([]),localStorage.removeItem("applyCart")};return(0,n.jsxs)("main",{style:{padding:32,maxWidth:900,margin:"0 auto"},children:[(0,n.jsx)("div",{style:{marginBottom:16}}),(0,n.jsx)("h2",{style:{fontSize:28,fontWeight:"bold",marginBottom:24},children:"申請清單"}),0===e.length?(0,n.jsx)("p",{children:"目前沒有任何宣導品在清單中。"}):(0,n.jsxs)("form",{onSubmit:g,style:{background:"#f7faff",border:"1px solid #cce0ff",borderRadius:12,padding:24,boxShadow:"0 2px 8px #0001"},children:[(0,n.jsxs)("table",{style:{width:"100%",marginBottom:24,borderCollapse:"collapse",background:"#fff"},children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{style:{borderBottom:"2px solid #0070f3",padding:8,textAlign:"center"},children:"名稱"}),(0,n.jsx)("th",{style:{borderBottom:"2px solid #0070f3",padding:8,textAlign:"center"},children:"數量"}),(0,n.jsx)("th",{style:{borderBottom:"2px solid #0070f3",padding:8,textAlign:"center"},children:"操作"})]})}),(0,n.jsx)("tbody",{children:e.map((e,t)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{style:{padding:8,textAlign:"center"},children:e.name}),(0,n.jsx)("td",{style:{padding:8,textAlign:"center"},children:(0,n.jsx)("input",{type:"number",min:1,value:e.count||1,onChange:e=>p(t,Number(e.target.value)),style:{width:60,padding:"4px 8px",border:"1px solid #0070f3",borderRadius:4,textAlign:"center"}})}),(0,n.jsx)("td",{style:{padding:8,textAlign:"center"},children:(0,n.jsx)("button",{type:"button",onClick:()=>c(t),style:{color:"#fff",background:"#ff4d4f",border:"none",borderRadius:4,padding:"4px 12px",cursor:"pointer"},children:"刪除"})})]},e.id))})]}),(0,n.jsxs)("div",{style:{marginBottom:16,display:"flex",alignItems:"center"},children:[(0,n.jsx)("label",{style:{minWidth:80},children:"領用日期："}),(0,n.jsx)("input",{type:"date",value:i,onChange:e=>a(e.target.value),required:!0,style:{marginLeft:8,padding:"6px 12px",border:"1px solid #0070f3",borderRadius:4}})]}),(0,n.jsxs)("div",{style:{marginBottom:16,display:"flex",alignItems:"center"},children:[(0,n.jsx)("label",{style:{minWidth:80},children:"領用原因："}),(0,n.jsx)("input",{type:"text",value:r,onChange:e=>l(e.target.value),required:!0,style:{marginLeft:8,width:300,padding:"6px 12px",border:"1px solid #0070f3",borderRadius:4}})]}),(0,n.jsx)("button",{type:"submit",style:{padding:"12px 32px",borderRadius:6,background:"#0070f3",color:"#fff",border:"none",fontSize:20,cursor:"pointer",marginTop:8,fontWeight:"bold"},children:"送出申請"}),o&&(0,n.jsx)("div",{style:{color:"green",marginTop:16,fontWeight:"bold"},children:"申請已送出！"})]})]})}i()},1246:(e,t,r)=>{Promise.resolve().then(r.bind(r,52))}},e=>{var t=t=>e(e.s=t);e.O(0,[874,441,684,358],()=>t(1246)),_N_E=e.O()}]);