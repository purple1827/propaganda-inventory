(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{4417:(e,t,n)=>{Promise.resolve().then(n.bind(n,7161))},5695:(e,t,n)=>{"use strict";var s=n(8999);n.o(s,"useRouter")&&n.d(t,{useRouter:function(){return s.useRouter}})},7161:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var s=n(5155),d=n(2115),i=n(5695);function r(){let[e,t]=(0,d.useState)([]),n=(0,i.useRouter)();(0,d.useEffect)(()=>{let e=JSON.parse(localStorage.getItem("loginUser")||"null");e&&"admin"===e.role||n.replace("/login")},[n]);let r="https://api.sheetbest.com/sheets/02b3aceb-e524-4741-b358-a70e97fe9b52",c="https://api.sheetbest.com/sheets/1522276e-7c68-4355-9a10-7cda433c7f90";(0,d.useEffect)(()=>{fetch(r).then(e=>e.json()).then(e=>t(e))},[]);let l=async(e,n,s,d)=>{if(await fetch("".concat(r,"/申請id/").concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({狀態:n})}),"已通過"===n){let e=await fetch("".concat(c,"/id/").concat(s)),t=await e.json();if(t.length>0){let e=Number(t[0]["剩餘數量"])-Number(d);await fetch("".concat(c,"/id/").concat(s),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({剩餘數量:e})})}}fetch(r).then(e=>e.json()).then(e=>t(e))};return(0,s.jsxs)("main",{style:{padding:24},children:[(0,s.jsx)("h1",{style:{fontSize:28,fontWeight:"bold",marginBottom:24},children:"申請審核管理"}),(0,s.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",background:"#fff"},children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{style:{background:"#f0f0f0"},children:[(0,s.jsx)("th",{children:"申請id"}),(0,s.jsx)("th",{children:"宣導品名稱"}),(0,s.jsx)("th",{children:"領用數量"}),(0,s.jsx)("th",{children:"領用日期"}),(0,s.jsx)("th",{children:"領用原因"}),(0,s.jsx)("th",{children:"狀態"}),(0,s.jsx)("th",{children:"操作"})]})}),(0,s.jsx)("tbody",{children:e.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:e["申請id"]}),(0,s.jsx)("td",{children:e["宣導品名稱"]}),(0,s.jsx)("td",{children:e["領用數量"]}),(0,s.jsx)("td",{children:e["領用日期"]}),(0,s.jsx)("td",{children:e["領用原因"]}),(0,s.jsx)("td",{children:e["狀態"]}),(0,s.jsxs)("td",{children:[(0,s.jsx)("button",{style:{marginRight:8,background:"#0070f3",color:"#fff",border:"none",borderRadius:4,padding:"4px 12px"},onClick:()=>l(e["申請id"],"已通過",e["宣導品id"],e["領用數量"]),disabled:"已通過"===e["狀態"],children:"同意"}),(0,s.jsx)("button",{style:{background:"#ff4d4f",color:"#fff",border:"none",borderRadius:4,padding:"4px 12px"},onClick:()=>l(e["申請id"],"已駁回",e["宣導品id"],e["領用數量"]),disabled:"已駁回"===e["狀態"],children:"駁回"})]})]},e["申請id"]))})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(4417)),_N_E=e.O()}]);